При работе в режиме подписи, схема Эль-Гамаля предполагает наличие фиксированной хеш-функции $h(\cdot)$, значения которой лежат в интервале $(1,p-1)$.

### Подпись сообщения

Для подписи сообщения $M$ выполняются следующие операции:
1. Вычисляется дайджест сообщения $M$: $m=h(M)$.
2. Выбирается случайное число $1<k<p-1$ взаимно простое с $p-1$ и вычисляется $r=g^k\mod p$.
3. Вычисляется число $s = (m-xr)k^{-1}\pmod{p-1}$, где $k^{-1}$ – это мультипликативное обратное $k$ по модулю $p-1$ (см. [[Наибольший общий делитель. Алгоритмы Евклида#^aaa269|Инверсия числа]]).
4. Подписью сообщения является пара $(r,s)$.

### Проверка подписи

Зная открытый ключ $(p,g,y)$, подпись $(r,s)$ сообщения $M$ проверяется следующим образом:
1. Проверяется выполнимость условий $1<r<p$ и $0<s<p-1$;
2. Если хотя бы одно из них не выполняется$\implies$подпись неверна;
3. Вычисляется дайджест $m=h(M)$;
4. Подпись считается верной, если выполняется сравнение:
$$y^rr^s\equiv g^m \pmod{p}$$
