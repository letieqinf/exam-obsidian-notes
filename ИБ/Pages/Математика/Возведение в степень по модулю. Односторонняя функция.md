### Возведение в степень по модулю

Возведение в степень по модулю имеет вид: $a^x\mod p$, где $a$, $x$ и $p$ – целые числа.
Вычислительные затраты: $O(2\log{p})$.

#### Справа налево

**Вход**: $a$, $x=(b_t,b_{t-1},...,b_0$), $p$.
**Выход**: $y=a^x\mod p$.

``` pascal
y <- 1; s <- a
for i=0,1,...,t do
	if b_i = 1 then y <- y * s mod p
	s <- s * s mod p
end for
return y
```

**Пример**:

Пусть $y=4^{101}\mod7$

| $i$ | 0 | 1 | 2 | 3 | 4 | 5 | 6 |
| :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: |
| $b_i$ | 1             | 0            | 1              | 0 | 0 | 1 | 1 |
| $y$ | $1*4\mod7=4$ | 4            | $4*4\mod7=2$ | 2            | 2           | $2*2\mod7=4$ | $4*4\mod7=2$ |
| $s$ | $4^2\mod7=2$   | $2^2\mod7=4$ | $4^2\mod7=2$   | $2^2\mod7=4$ | $4^2\mod7=2$| $2^2\mod7=4$  | $4^2\mod7=2$ |

Ответ: $y=2$

#### Слева направо

**Вход**: $a$, $x=(b_t,b_{t-1},...,b_0$), $p$.
**Выход**: $y=a^x\mod p$.

``` pascal
y <- 1; s <- a
for i=t-1,...,0 do
	y <- y * y mod p
	if b_i = 1 then y <- y * s mod p
end for
return y
```

**Пример**:

Пусть $y=4^{101}\mod7$

| $i$ | 6 | 5 | 4 | 3 | 2 | 1 | 0 |
| :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: |
| $b_i$ | 1                | 1              | 0            | 0           | 1              | 0            | 1              |
| $y_i$ | $1^2\mod7=1$     | $4^2\mod7=2$   | $1^2\mod7=1$ | $1^2\mod7=1$ | $1^2\mod7=1$   | $4^2\mod7=2$ | $2^2\mod7=4$   |
| $y$  | $1*4\mod7=4$   | $2*4\mod7=1$ | $1$            | $1$            | $1*4\mod7=4$ | $2$            | $4*4\mod7=2$ |

Ответ: $y=2$

### Односторонняя функция

**Односторонняя функция** — функция, вычисление которой по формуле $y=f(x)$ является вычислительно простой задачей, не требующей много времени, а вычисление по формуле $x=f^{-1}(y)$ является вычислительно сложной задачей, требующей привлечения больших вычислительных ресурсов.

**Пример**:

$y=a^x\mod p$ ($p$ – простое, $x<p$) — односторонняя
*Обратная к ней*: $a^x=y\mod p$ или дискретный логарифм $x=\log_a y\mod p$ — вычислительная сложность составляет $O(2\sqrt{p})$.

