*Data Encryption Algorithm*

**Основные характеристики**:
- Алгоритм *блочного шифрования*;
- Основан на *[[Сеть Фейштеля|сети Фейштеля]]*;
- *Размер блока*: 64 бита;
- *Длина ключа*: 56 бит (раундовый - 48 бит);
- *Количество раундов*: 16;
- Стандарт симметричного шифрования.

![[DES.png]]
Рисунок 1 — Графический вид алгоритма DES, функции $F$ и формирования раундовых ключей
### Функция преобразования

На вход функции $F$ поступает правый подблок (32 бита) и раундовый ключ (48 бит). Для согласования размеров блока и ключа используется **функция расширения**:

| Этап | Сообщение | Пояснение |
| :-: | :-: | :-: |
| 1 | $01101011\space10111111\space00110110\space10110010$ | Исходное сообщение |
| 2 | $0110\space1011\space1011\space1111\space0011\space0110\space1011\space0010$ | Сообщение разбивается на четверки |
| 3 | $0\underline{0110}1\space0\underline{1011}1\space1\underline{1011}1\space1\underline{1111}0\space1\underline{0011}0\space1\underline{0110}1\space0\underline{1011}0\space1\underline{0010}0$ | В конец четверки дописывается первый бит следующей, а в начало – последний бит предыдущей |
| 4 | $00110101\space01111101\space11111110\space10011010\space11010101\space10100100$ | Результат расширения |

После сложения по модулю $2$ с ключом $K_i$, результат разбивается на группы по 6 бит и к каждой применяется **таблица перестановки** $S$:
- *Номер строки*: крайние биты ($\underline10011\underline0$);
- *Номер столбца*: внутренние биты ($1\underline{0011}0$).
В результате формируется 32-битный блок, к которому применяется таблица перестановки $IP$.
### Генерация раундовых ключей

1. Ключ дополняется до 64 бит посредством вставки на позиции 8, 16, 24, 32, 40, 48 и 64 битов контроля по четности (либо они уже там есть);
2. Производится перестановка битов при помощи таблицы перестановки 
	*Таблица перестановки – 56-битная таблица, содержащая позиции, на которые будут переставлены биты* $$G=\left[\space{\begin{array}{ccccccc}
	57 & 49 & 41 & 33 & 25 & 17 & 09 \\
	01 & 58 & 50 & 42 & 34 & 26 & 18 \\
	10 & 02 & 59 & 51 & 43 & 35 & 27 \\
	19 & 11 & 03 & 60 & 52 & 44 & 36 \\
	63 & 55 & 47 & 39 & 31 & 23 & 15 \\
	07 & 62 & 54 & 46 & 38 & 30 & 22 \\
	14 & 06 & 61 & 53 & 45 & 37 & 29 \\
	21 & 13 & 05 & 28 & 20 & 12 & 04
	\end{array}}\space\right]$$
3. Результат (56 бит) разбивается на два блока $C_0$ (первые 28 бит) и $D_0$  (последние 28 бит).
4. Для $i$-ого ключа вычисляются $C_i$ и $D_i$ посредством циклического сдвига $С_{i-1}$ и $D_{i-1}$ соответственна на $1$ или $2$ в зависимости от итерации

| 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 | 15 | 16 |
| :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: |
| 1 | 1 | 2 | 2 | 2 | 2 | 2 | 2 | 1 | 2 | 2 | 2 | 2 | 2 | 2 | 1 |
### Расшифрование

Происходит аналогично, но при $i=16,...,1$, а также $R_{i-1}=L_i$ и $L_{i-1}=R_i\oplus{F(L_i, K_i)}$.
### Упрощенный DES (S-DES)

Шифрование происходит 8-битными блоками с использованием 10-битного ключа. Производится только 2 раунда.