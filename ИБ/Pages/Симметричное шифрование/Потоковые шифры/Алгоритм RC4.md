*Rivest cipher 4*

**Основные характеристики**:
- Алгоритм [[Потоковые шифры|поточного]] шифрования;
- Вычисления проводятся по $\mod{2^n}$, где $n$ – количество бит в слове;
- Используется ключ $k$ длины $l$ для формирования ключевой последовательности.

**Шифрование**:
$c_i=m_i\oplus{k_i}$

**Расшифрование**:
$m_i=c_i\oplus{k_i}$
### Инициализация $S$-блока

1. Формируется таблица $S$, содержащая значения $[0,2^n]$;
2. В цикле на каждой итерации вычисляется индекс $j$, с которым будет происходить перестановка текущего элемента $S$ согласно формуле:
$$j_i={(j_{i-1}+S_i+K_{i\mod{l}})}\mod{2^n}$$
3. Элементы меняются местами;

### Генерация псевдослучайной последовательности $K$

1. На основе итоговой таблицы $S$ на каждой итерации вычисляются индексы для повторной перестановки согласно формулам:
$$i=(i+1)\mod{2^n}$$
$$j=(j+S_i)\mod{2^n}$$
2. Элементы на полученных индексах меняются местами;
3. Вычисляется индекс обращения к массиву для выдачи псевдослучайного элемента последовательности по формуле:
$$T={(S_i+S_j)}\mod{2^n}$$
4. Выбирается элемент $S_T$.


**Преимущества**:
- Высокая скорость работы;
- Переменная длина ключа.

**Недостатки**:
- Уязвимость, если используются не случайные или связные ключи, а также один ключевой поток используется дважды.

