*Алгоритмы симметричного шифрования работают блоками фиксированного размера. Реальные тексты состоят из большего количества символов и для их шифрования существует несколько режимов работы блочных алгоритмов.*

**Режим шифрования** — метод применения блочного шифра, позволяющий преобразовать последовательность блоков открытых данных в последовательность блоков зашифрованных данных.

---

**Режим электронный кодовой книги** (ECB, Electronic CodeBook);

*Шифрование*:
	$M=M_1,M_2,...,M_n$
	$C_i=E_k(M_i)$ при $i=1,...,n$

*Дешифрование*:
	$M_i=D_k(C_i)$ при $i=1,...,n$

Повторяющиеся блоки текста будут зашифрованы одинаково

![[Режим работы 1.png]]

---
**Режим сцепления блоков** (CBC, Cipher Block Chaining);

*Шифрование*:
	$C_i=E_k(M_i\oplus{C_{i-1}})$ при $i=1,...,n$
	$C_0=IV$

*Дешифрование*:
	$M_i=D_k(C_i)\oplus{C_{i-1}}$ при $i=1,...,n$
	$C_0=IV$

$IV$ — вектор инициализации (определяется по согласованию)

![[Режим работы 2.png]]

---

**Режим обратной связи по шифротексту** (CFB, Cipher FeedBack);

*Шифрование*:
	$C_i=E_k(C_{i-1})\oplus{M_i}$ при $i=1,...,n$
	$C_0=IV$

*Дешифрование*:
	$M_i=E_k(C_{i-1})\oplus{C_i}$ при $i=1,...,n$
	$C_0=IV$

И при шифровании, и при дешифровании используется только функция $E$

![[Режим работы 3.png]]

---

**Режим обратной связи по выходу** (OFB, Output FeedBack).

*Шифрование*:
	$C_0=IV$
	$E^{0}_k=E_k(C_0)$
	$C_i=M_i\oplus{E^{i}_k(E^{i-1}_k)}$ при $i=1,...,n$

*Дешифрование*:
	$C_0=IV$
	$E^{0}_k=E_k(С_0)$
	$M_i=C_i\oplus{E^{i}_k(E^{i-1}_k)}$ при $i=1,...,n$

![[Режим работы 4.png]]

---

*Режимы шифрования используются для модификации процесса шифрования так, чтобы результат шифрования каждого блока был уникальным вне зависимости от шифруемых данных и не позволял сделать какие либо выводы о структуре исходного сообщения. Это вызвано прежде всего тем, что блочные шифры шифруют данные блоками фиксированного размера и поэтому существует потенциальная возможность утечки информации о повторяющихся частях данных, которые шифруются с помощью одного и того же ключа.*